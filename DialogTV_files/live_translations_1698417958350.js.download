var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},__assign.apply(this,arguments)},__read=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,a=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i},__spreadArray=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};!function(){function e(e){void 0===e&&(e=!1);var t=["SVG","SCRIPT","STYLE","NOSCRIPT"],n=[],r=document.body,o=function(e){return e[p.PARSED]=!0},a=function(e){return e[p.PARSED]=!1},i=function(e){return!!e[p.PARSED]},u=function(t){return function(n){return!!n[p.FORCED]||(e?t(n):!t(n))}}(i),s=[function(e){var t="INPUT"===e.tagName;if(t){var n=e.getAttribute("type");if(n){n=n.toLowerCase();var r=e.getAttributeNode("value"),o="button"===n,a="reset"===n,i="submit"===n;return t&&(o||a||i)&&r}}}],l=P(m,s),c=function(e){if(e.className&&-1!==e.className.indexOf("uwy")&&"application"===e.getAttribute("role"))return!0;if(e.getAttribute("data-uw-ignore-translate"))return!0;var t=e.tagName&&e.tagName.toUpperCase();return"TEXTAREA"===t||"CODE"===t||"PRE"===t||!!e.getAttribute("contenteditable")};W(r)&&u(r)&&!c(r)&&n.push(r),l(r).forEach(function(e){u(e)&&(o(e),n.push(e))});var d=function(e){e.hasChildNodes()&&!c(e)&&Array.from(e.childNodes).forEach(function(e){var r=e.tagName&&e.tagName.toUpperCase();if((!r||-1===t.indexOf(r))&&(b[y]&&(Object.values(b[y]).includes(e.nodeValue)||a(e)),e.nodeType===Node.TEXT_NODE&&u(e)&&W(e)&&(o(e),(e.nodeValue.startsWith(" ")||e.nodeValue.startsWith(" "))&&(e[f]=e.nodeValue[0]),(e.nodeValue.endsWith(" ")||e.nodeValue.endsWith(" "))&&(e[g]=e.nodeValue.slice(-1)),n.push(e)),e.nodeType===Node.ELEMENT_NODE))if("IFRAME"===r){var i=e,s=i.baseURI.includes(document.location.origin);if(s)try{var c=i.contentDocument||i.contentWindow.document;d(c.body)}catch(e){console.log("Error::","parse embed iframe",e)}}else l(e).forEach(function(e){u(e)&&(o(e),n.push(e))}),d(e)})};return d(r),n}function t(e,t){return u.request({method:"POST",url:d+"/remediation/translate",header:{"Content-Type":"application/json"},body:{translateAccCode:UserWayWidgetApp.ContextHolder.config.account,translateSiteId:UserWayWidgetApp.ContextHolder.config.services.siteId,translatePageUrl:window.location.href,translateSentences:e,translateToLanguage:t}}).then(function(e){try{return JSON.parse(null===e||void 0===e?void 0:e.response)}catch(e){return console.error(a,e),null}}).then(function(e){return(null===e||void 0===e?void 0:e.code)&&200!==(null===e||void 0===e?void 0:e.code)?(console.error(a,null===e||void 0===e?void 0:e.message),null):e})}function n(e){var t=e.resolve,n=e.reject,r=e.items;if(!r.length)return t();if(!y)return n(a+": No language specified!");try{C(r,y).then(function(){return O(r)}).catch(function(e){return n(e)})}catch(e){console.log("Error::",a,e),n(e)}t()}function r(e){return w()?e.filter(function(e){return!A(e)}):e}function o(t){var n=e(!0);return Promise.all(n.map(function(e){var n=T(e.nodeValue,t,e);return n?R(e,n).then(function(){delete e[p.PARSED]}):(console.log("Can't revert translation for the node: ",e),Promise.resolve())}))}var a="LIVE_TRANSLATIONS",i=UserWayWidgetApp.addLib(a),u=UserWayWidgetApp.getLib("util"),s=UserWayWidgetApp.ContextHolder.config.services,l=window.UserWayWidgetApp.getLib("dom_observer"),c=window.UserWayWidgetApp.getLib("event_emitter"),d="https://api.userway.org/api",f="string_start_space_value",g="string_end_space_value",v=l.DOM_OBSERVER_DOM_CHANGED_EVENT,p={PARSED:"prs",FORCED:"uw_forced_translate"},m=function(){return 254989===(null!==s&&void 0!==s?s:s.userId)?["title","alt","placeholder"]:["aria-label","title","alt","placeholder"]}(),h=["$"],y=null,b={},E=!1,_=null,w=function(){return!!b[y]},A=function(e){return b[y][e]},T=function(e,t,n){e=u.customTrim(e);var r=b[t],o=Object.keys(r).find(function(t){return r[t]===e});return r?n[f]||n[g]?L(n,o):o:null},S=function(e){return b[y]=__assign(__assign({},b[y]),e)},N=function(){if(E){var t=e();i.doRemediation(null,t)}};i.getCurrentLanguage=function(){return y},i.enable=function(){E=!0,c.on(v,N)},i.disable=function(){E=!1,c.off(v,N)},i.isEnabled=function(){return E},i.awaitForResources=function(){var e=window.localStorage.getItem("userway-selectedSiteLang"),t=s.LIVE_TRANSLATIONS&&s.LIVE_TRANSLATIONS.autoTranslation&&e;return t?(y=e,i.translateSite().then(function(){return t})):(window.localStorage.removeItem("userway-selectedSiteLang"),Promise.resolve(t))},i.doRemediation=function(e,t){return new Promise(function(e,r){n({items:t,resolve:e,reject:r})})},i.translateSite=function(t){if(void 0===t&&(t=y),"rakbank"===!UserWayWidgetApp.ContextHolder.config.partner){var n=new CustomEvent("userway:translate",{detail:{locale:t},bubbles:!1,cancelable:!0});if(!document.dispatchEvent(n))return Promise.resolve()}if(!t)return console.error(a,"No translation language specified!"),Promise.resolve();if(_===t)return Promise.resolve();var r=e();return y=t,document.querySelector("html").setAttribute("lang",y),C(r,t).then(function(){return O(r)}).then(function(){return i.enable()}).catch(function(e){return console.log("Error::",a,e)})},i.revertToOriginal=function(){if(!i.isEnabled())return Promise.resolve();i.disable();var e=y;return y=null,o(e)};var P=function(e,t){return void 0===t&&(t=[]),function(n){return n?e.map(function(e){return n.getAttributeNode(e)}).concat(t.map(function(e){return e(n)})).filter(Boolean):[]}},W=function(e){if(!e)return!1;var t=e.nodeType,n=e.nodeValue;return t===Node.TEXT_NODE&&n.length>0&&-1===n.search(/^\s+$/i)},C=function(e,n){var o=new Set;e.forEach(function(e){var t=u.customTrim(e.nodeValue);o.add(t)});var i=r(__spreadArray([],__read(o),!1));if(!i.length)return Promise.resolve();var s={"pt-BR":"pt","es-MX":"es","en-US":"en","en-AU":"en","en-GB":"en"};return s[n]&&(n=s[n]),t(i.filter(function(e){return""!==e}),n).then(function(e){if(!e)throw new Error(a+": No translation data.");S(e.data.translations)})},O=function(e){return Promise.all(e.map(function(e){var t=u.customTrim(e.nodeValue);if(h.includes(t))return Promise.resolve();var n=e[f]||e[g]?L(e,A(t)):A(t);return n?R(e,n):(console.log("Node ",e," is not translated."),Promise.resolve())}))},L=function(e,t){return t?(e[g]&&e[f]?t=e[f]+t+e[g]:e[f]?t=e[f]+t:t+=e[g],t):null},R=function(e,t){return new Promise(function(n){var r=e.parentElement;if(e.nodeValue===t)return n();if(!r)return e.nodeValue=t,n();var o=r.style.backgroundColor,a=r.style.transition;setTimeout(function(){r.style.backgroundColor="rgba(255,241,141,0.9)",r.style.transition="background-color 0.3s",e.nodeValue=t,setTimeout(function(){r.style.backgroundColor=o,setTimeout(function(){r.style.transition=a,n()},300)},300)})})},V=function(){u.postMessage({action:"websiteTranslationCompleted"}),window.postMessage({isUserWay:!0,action:"websiteTranslationCompleted"},"*")},I=function(){window.postMessage({isUserWay:!0,action:"websiteTranslationReverted"},"*")},U=function(e){window.localStorage.setItem("userway-selectedSiteLang",e),document.documentElement.setAttribute("lang",e)},D=function(){var e=UserWayWidgetApp.ContextHolder.config.widgetPageLang;document.documentElement.setAttribute("lang",e),window.localStorage.removeItem("userway-selectedSiteLang")};!function(){var e=document.querySelector("html");_=e.getAttribute("lang");var t=function(e){var t=e.data,n=t.action,r=t.value,o=t.shouldNotTriggerLiveTranslation,a=void 0!==o&&o;switch(n){case"setWidgetLanguage":case"disableLiveTranslation":if(a)break;i.revertToOriginal().then(function(){return D()}).then(function(){return I()});break;case"translateWebsite":i.revertToOriginal().then(function(){return U(r)}).then(function(){return i.translateSite(r)}).then(function(){return V()})}};u.registerPostMessageListener(t)}()}();